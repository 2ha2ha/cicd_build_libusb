cmake_minimum_required(VERSION 3.10)
project(QLinkLib VERSION 1.0.0 LANGUAGES C)

set(CMAKE_C_STANDARD 11)
set(CMAKE_C_STANDARD_REQUIRED ON)

add_library(QLinkLib SHARED QLinkLib.c)

target_include_directories(QLinkLib PUBLIC
    stlink/include
    stlink/include/libusb-1.0
)

# 指定库文件目录并链接
message(STATUS "Library path: ${CMAKE_SOURCE_DIR}/stlink/lib")
link_directories(${CMAKE_SOURCE_DIR}/stlink/lib)
target_link_libraries(QLinkLib PRIVATE 
    stlink-static
    libusb-1.0  # 添加其他必要依赖
)


set_target_properties(QLinkLib PROPERTIES
    RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/dll"
    LIBRARY_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/dll"
)